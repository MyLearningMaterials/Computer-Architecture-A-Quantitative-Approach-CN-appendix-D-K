# D.4 I/O性能，可靠性措施和基准

I/O性能的度量方法有一些没有在设计中体现。其中之一是**多样性**：哪些I/O设备可以连接到计算机系统?另一个是**容量**：有多少I/O设备可以连接到计算机系统?

除了这些独特的度量之外，传统的性能度量(即响应时间和吞吐量)也适用于I/O。(I/O吞吐量有时称为I/O带宽，响应时间有时称为延迟。)接下来的两个图展示了响应时间和吞吐量是如何对抗和权衡的。图D.8显示了简单的生产者-服务器模型。生产者创建要执行的任务并将它们放在缓冲区中；服务器从先入先出缓冲区接收任务并执行它们。

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption><p>图D.8响应时间和吞吐量的传统生产者-服务器模型。响应时间从任务放入缓冲区时开始，到服务器完成任务时结束。吞吐量是指服务器在单位时间内完成的任务数量。</p></figcaption></figure>

响应时间定义为任务从放入缓冲区到服务器完成任务所花费的时间。吞吐量是服务器在一段时间内完成的任务的平均数量。为了获得尽可能高的吞吐量，服务器不应该处于空闲状态，因此缓冲区不应该为空。

I/O性能的另一个度量是I/O对处理器执行的干扰。传输数据可能会干扰另一个进程的执行。处理I/O中断也有开销。这里我们关心的是一个进程由于I/O被另一个进程占用了多长时间。

### 吞吐量与响应时间

图D.9显示了典型I/O系统的吞吐量与响应时间(或延迟)的关系。曲线的拐点是这样一个区域，在这个区域中，稍微多一点的吞吐量会导致更长的响应时间，或者相反，稍微短一点的响应时间会导致更低的吞吐量。

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption><p>图D.9吞吐量与响应时间的关系。延迟通常报告为响应时间。请注意，最小响应时间仅达到吞吐量的11%，而100%吞吐量的响应时间是最小响应时间的7倍。还要注意，这条曲线中的自变量是隐式的;要跟踪曲线，通常需要改变负载(并发性)。Chen等人[1990]收集了一组磁盘的这些数据。</p></figcaption></figure>

架构师如何平衡这些相互冲突的需求？如果计算机正在与人交互，图D.10给出了一个答案。与计算机的交互或交易分为三个部分:

1. 进入时间——用户输入命令的时间
2. 系统响应时间——用户输入命令到得到完整响应的时间
3. 思考时间——从接收到响应到用户开始输入下一个命令的时间

<figure><img src="../.gitbook/assets/image (2).png" alt=""><figcaption><p>图D.10用户与交互式计算机之间的事务处理，对于传统系统和图形系统，分为输入时间、系统响应时间和用户思考时间。进入时间是相同的，与系统响应时间无关。传统系统的输入时间为4秒，图形系统的输入时间为0.25秒。响应时间的减少实际上减少了事务时间，而不仅仅是响应时间的减少。(摘自布雷迪[1986])</p></figcaption></figure>

这三个部分的总和称为事务时间。一些研究报告称，用户生产力与事务时间成反比。图D.10的结果表明，将系统响应时间缩短0.7秒将比传统事务节省4.9秒(34%)，比图形事务节省2.0秒(70%)。这个令人难以置信的结果可以用人性来解释：当人们得到更快的反应时，他们需要更少的时间来思考。尽管这项研究已经进行了20年，但即使处理器的速度提高了1000倍，响应时间仍然比1秒慢得多。长时间延迟的例子包括由于磁盘I/O过多而在桌面PC上启动应用程序，或者单击Web链接时出现网络延迟。

为了反映响应时间对用户工作效率的重要性，I/O基准测试还处理响应时间与吞吐量之间的权衡。图D.11显示了三个I/O基准的响应时间界限。在给定90%的响应时间必须小于限制或平均响应时间必须小于限制的情况下，它们报告最大吞吐量。

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption><p>图D.11三个I/O基准的响应时间限制</p></figcaption></figure>

### 事务处理基准

事务处理(TP，或联机事务处理的OLTP)主要关注I/O速率(每秒磁盘访问的次数)，而不是数据速率(以每秒传输的字节数衡量)。TP通常涉及对来自许多终端的大量共享信息的更改，TP系统保证故障时的正确行为。例如，假设当客户试图从ATM机中取款时，银行的计算机出现故障。TP系统将保证，如果客户收到钱，账户将被借记，如果客户没有收到钱，账户将保持不变。航空公司预订系统和银行都是TP的传统客户。
